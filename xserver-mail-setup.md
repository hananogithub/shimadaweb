# 📧 エックスサーバー メール送信設定ガイド

## エックスサーバーでのメール送信問題解決

### 🎯 主な問題と解決策

#### 1. Fromヘッダーの問題
**問題**: 独自ドメイン以外のメールアドレスを使用すると迷惑メール判定される

**解決策**: 
- `From: info@shimadaweb.online` を使用
- 独自ドメインのメールアドレスを必ず指定

#### 2. SPF/DKIM設定
**問題**: DNSレコードが正しく設定されていないとGmail/Outlookで弾かれる

**解決策**:
1. エックスサーバーのサーバーパネルにログイン
2. 「DNSレコード設定」を選択
3. 以下のレコードを追加：

```
SPFレコード:
v=spf1 +a +mx +ip4:サーバーIP include:xsrv.jp ~all

DKIMレコード:
サーバー側で有効化（エックスサーバーが自動設定）
```

#### 3. 迷惑メールフォルダの確認
**問題**: メールが送信されているが迷惑メールフォルダに入っている

**解決策**:
1. Gmail/Outlookの迷惑メールフォルダを確認
2. `info@shimadaweb.online` を許可リストに追加

### 🔧 エックスサーバーでの設定手順

#### ステップ1: メールアカウントの作成
1. エックスサーバーのサーバーパネルにログイン
2. 「メール」→「メールアカウント設定」
3. 以下のアカウントを作成：
   - アカウント名: `info`
   - ドメイン: `shimadaweb.online`
   - パスワード: 強力なパスワードを設定

#### ステップ2: DNSレコードの設定
1. 「DNSレコード設定」を選択
2. 以下のレコードを追加：

```
Type: TXT
Name: @
Value: v=spf1 +a +mx +ip4:サーバーIP include:xsrv.jp ~all

Type: TXT
Name: default._domainkey
Value: （エックスサーバーが自動生成）
```

#### ステップ3: PHP設定の確認
1. 「php.ini設定」を選択
2. 以下の設定を確認：
   - `mail()` 関数: 有効
   - エラーログ: 有効（デバッグ用）

### 📁 アップロードするファイル

#### 必須ファイル
- `index.html` - メインページ（PHPファイル対応）
- `contact-xserver.php` - エックスサーバー用メール送信処理
- `script.js` - JavaScript（PHPファイル対応）

#### 設定ファイル
- `.htaccess` - Apache設定
- `robots.txt` - 検索エンジン用
- `sitemap.xml` - サイトマップ

### ✅ 動作確認手順

#### 1. ファイルのアップロード
1. エックスサーバーのファイルマネージャーを開く
2. `public_html/` にファイルをアップロード
3. ファイル権限を設定（644）

#### 2. メール送信のテスト
1. `https://shimadaweb.online/` でフォーム送信
2. `info@shimadaweb.online` にメールが届くか確認
3. 迷惑メールフォルダもチェック

#### 3. エラーログの確認
1. サーバーパネルでエラーログを確認
2. PHPエラーがないか確認
3. メール送信エラーがないか確認

### 🚨 トラブルシューティング

#### メールが送信されない場合
1. **エラーログを確認**
   - サーバーパネルでエラーログを確認
   - PHPエラーの詳細を確認

2. **Fromヘッダーを確認**
   - `info@shimadaweb.online` を使用しているか
   - 独自ドメインのメールアドレスか

3. **DNS設定を確認**
   - SPFレコードが正しく設定されているか
   - DKIMレコードが有効になっているか

#### メールが迷惑メールに分類される場合
1. **送信先で許可リストに追加**
   - `info@shimadaweb.online` を許可リストに追加
   - 迷惑メールフィルタを調整

2. **SPF/DKIM設定を確認**
   - DNSレコードが正しく設定されているか
   - エックスサーバーの設定を確認

### 📞 サポート

問題が解決しない場合は、以下を確認してください：
1. エックスサーバーのエラーログ
2. メール送信の詳細ログ
3. DNS設定の確認結果

これらの情報があれば、より具体的なサポートを提供できます。

### 🎉 成功の確認

すべて正常に設定されると：
- ✅ フォーム送信が成功する
- ✅ `info@shimadaweb.online` にメールが届く
- ✅ 迷惑メールフォルダに入らない
- ✅ 返信が正常に送信できる

これで、エックスサーバーでのメール送信が安定して動作します！
